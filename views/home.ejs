<%- include("partials/header"); -%>

<div class="mt-2 mb-5 container max-700">
    <div class="row mb-2">
        <div class="col d-flex justify-content-start">
            <a class="link" href="/compose">+ Compose</a>
        </div>
      </div> 
    <div class="row">
        <div class="col">
            <h1 class="titles">Home</h1>
        </div>
    </div>
    <% if (posts.length === 0){ %>
        <div class="row">
            <div class="col empty-home justify-content-center" >
                Your journal is empty. Add your daily notes           
                <a class="link empty-home-link text-decoration-underline" href="/compose"> 
                   Here <i class="fa-solid fa-feather"></i> 
                </a>
            </div>
        </div>  
     <% }else { %>
        <div class="row">
            <div class="col">
<% console.log(alert)%>
                <% if(typeof alert !== undefined) { %>
                    <% alert.forEach(function(alert) { %>
                        <div class="alert alert-success alert-dismissible fade show" role="alert">
                           <% console.log(alert.msg) %> 
                            <%= alert.msg %>
                          </div>
                    <% }) %>
                <% } %>
               

                <div >
                    <% posts.forEach(function(post){ %>
                    <a class="link" href="/posts/<%=post._id%>"><h3><%= post.title %></h3></a>
                        <p class="lastSeen">
                            Last edited: 
                            <%= new Date(post.updatedAt).toLocaleDateString(
                                "en-US", 
                                {weekday: "long",
                                 day: "numeric",
                                 month: "long", 
                                 year: "numeric"}
                            )%>
                        </p>
                        <p class="mb-5">
                            <%=post.content.substring(0,200) + " ...   " %>
                            <a class="link" href="/posts/<%=post._id%>">Read more</a>
                        </p>
                    <% }) %>
                </div>
            </div> 
        </div>
    <% } %>
</div>
        
<%- include("partials/footer"); -%>
